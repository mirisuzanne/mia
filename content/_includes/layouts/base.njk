{%- import 'utility.macros.njk' as utility -%}
{%- import 'site/macros.njk' as show -%}
{%- import 'events/macros.njk' as cal -%}
<!doctype html>
<html lang="en" data-theme="light">
	{%- set meta_title = renderData.title or title -%}
	{%- set desc = sub or summary or content or none -%}
	{%- set desc = desc | mdInline | striptags | truncate | replace('&nbsp;', ' ') | replace('&amp;', '&') if desc else desc -%}
	{%- set meta_desc = description or desc or site.description -%}
	{%- set full_title = banner or meta_title -%}
	<head>
		<meta charset="utf-8" />
		<meta name="viewport"
      content="width=device-width, initial-scale=1.0" />

    <title>{{ [meta_title, site.title] | join(' | ') }}</title>
    <meta name="description"
      content="{{ meta_desc }}" />

		<script src="https://use.typekit.net/slx1xnq.js"></script>
		<script>try{Typekit.load({ async: true });}catch(e){}</script>

		{% for url in site.styles %}
			<link rel="stylesheet"
				href="/assets/css/{{ url }}" />
		{% endfor %}

    {% include 'site/og.njk' %}
    {% include 'site/feed.njk' %}
	</head>

	<body
		data-layout="body"
		data-area="full"
		data-flow="grid">
		{% include 'site/banner.njk' %}
		{% include 'site/nav.njk' %}
		{% include 'site/hero.njk' %}

    {% block main %}
      {{ show.main(content, section, erasure) }}
    {% endblock %}

		{% include 'site/series.njk' %}

		{% block calendar %}
      {% include 'site/calendar.njk' %}
		{% endblock %}

		{% include 'site/footer.njk' %}

		<script type="text/javascript">
			const erase = document.querySelector("[data-erase]");
			const eraseBtn = document.querySelector("[data-toggle='erase']");

			const toggleErase = () => {
				const states = {
					off: 'on',
					on: 'off',
				};
				const current = erase.getAttribute('data-erase');
				const setTo = states[current];
				erase.setAttribute('data-erase', setTo);
				eraseBtn.setAttribute('data-active', setTo === 'on');
			}

			if (eraseBtn) {
				eraseBtn.addEventListener("click", () => {
					toggleErase();
				});
			}
		</script>

		<!-- Current page: {{ page.url | url }} -->
	</body>
</html>
